source [file dirname [info script]]/testing.tcl

needs cmd aes

test aes-1.1 "AES encrypt a string with AES_CBC_256" {
    aes encrypt {a key} {a text}
} {4899C9FD5B4A97B2B67A195B8E4D9AB4}

test aes-1.2 "AES decrypt a string with AES_CBC_256" {
    aes decrypt -type AES_CBC_256 {a key} 4899C9FD5B4A97B2B67A195B8E4D9AB4
} {a text}

test aes-1.3 "AES encrypt a string with AES_ECB_128" {
    aes encrypt -type AES_ECB_128 {a key} {a text}
} {DA4E3E58599873C8BB57AF436EDBF5DB}

test aes-1.3 "AES decrypt a string with AES_ECB_128" {
    aes decrypt -type AES_ECB_128 {a key} DA4E3E58599873C8BB57AF436EDBF5DB
} {a text}

testreport
